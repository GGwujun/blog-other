<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-other/umi.css" />
    <script>
      window.routerBase = "/blog-other";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>15 | 平台：智能家居开源平台的生态是怎样的？ - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/物联网开发实战/04.进阶篇/10" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-other/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>前端开发<ul><li><a href="/blog-other/说透低代码">说透低代码</a></li><li><a href="/blog-other/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li></ul></span><span>产品与用户体验<ul><li><a href="/blog-other/大厂广告产品心法">大厂广告产品心法</a></li></ul></span><span>面试<ul><li><a href="/blog-other/技术面试官识人手册">技术面试官识人手册</a></li><li><a href="/blog-other/面试现场">面试现场</a></li></ul></span><span>杂谈<ul><li><a href="/blog-other/乔新亮的cto成长复盘">乔新亮的cto成长复盘</a></li><li><a href="/blog-other/互联网人的英语私教课">互联网人的英语私教课</a></li><li><a href="/blog-other/从0开始学游戏开发">从0开始学游戏开发</a></li><li><a href="/blog-other/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog-other/手机摄影">手机摄影</a></li><li><a aria-current="page" class="active" href="/blog-other/物联网开发实战">物联网开发实战</a></li><li><a href="/blog-other/白话法律42讲">白话法律42讲</a></li><li><a href="/blog-other/说透5g">说透5g</a></li><li><a href="/blog-other/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog-other/零基础实战机器学习">零基础实战机器学习</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-other/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>前端开发<ul><li><a href="/blog-other/说透低代码">说透低代码</a></li><li><a href="/blog-other/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li></ul></li><li>产品与用户体验<ul><li><a href="/blog-other/大厂广告产品心法">大厂广告产品心法</a></li></ul></li><li>面试<ul><li><a href="/blog-other/技术面试官识人手册">技术面试官识人手册</a></li><li><a href="/blog-other/面试现场">面试现场</a></li></ul></li><li>杂谈<ul><li><a href="/blog-other/乔新亮的cto成长复盘">乔新亮的cto成长复盘</a></li><li><a href="/blog-other/互联网人的英语私教课">互联网人的英语私教课</a></li><li><a href="/blog-other/从0开始学游戏开发">从0开始学游戏开发</a></li><li><a href="/blog-other/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog-other/手机摄影">手机摄影</a></li><li><a aria-current="page" class="active" href="/blog-other/物联网开发实战">物联网开发实战</a></li><li><a href="/blog-other/白话法律42讲">白话法律42讲</a></li><li><a href="/blog-other/说透5g">说透5g</a></li><li><a href="/blog-other/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog-other/零基础实战机器学习">零基础实战机器学习</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-other/物联网开发实战">物联网开发实战</a></li><li><a href="/blog-other/物联网开发实战/01.2022特别加更">01.2022特别加更</a><ul><li><a href="/blog-other/物联网开发实战/01.2022特别加更/01"><span>引子｜RISC-V：物联网领域值得关注的芯片趋势是什么？</span></a></li><li><a href="/blog-other/物联网开发实战/01.2022特别加更/02"><span>实战一｜嵌入式开发：如何使用C语言开发智能电灯？</span></a></li><li><a href="/blog-other/物联网开发实战/01.2022特别加更/03"><span>实战二｜MQTT开发：如何实现联网控制？</span></a></li><li><a href="/blog-other/物联网开发实战/01.2022特别加更/04"><span>假期快乐｜这是一份暂时停更的声明</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/02.开篇词">02.开篇词</a><ul><li><a href="/blog-other/物联网开发实战/02.开篇词/01"><span>开篇词 | 物联网这个趋势，你不应该错过</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/03.基础篇">03.基础篇</a><ul><li><a href="/blog-other/物联网开发实战/03.基础篇/01"><span>01 | 入门介绍：如何定义物联网？</span></a></li><li><a href="/blog-other/物联网开发实战/03.基础篇/02"><span>02 | 通信技术：设备接入网络的方式有哪些？</span></a></li><li><a href="/blog-other/物联网开发实战/03.基础篇/03"><span>03 | 网络协议：设备使用什么语言与互联网对话？</span></a></li><li><a href="/blog-other/物联网开发实战/03.基础篇/04"><span>04 | 数据分析：数据的价值有哪些？</span></a></li><li><a href="/blog-other/物联网开发实战/03.基础篇/05"><span>05 | 系统实例：怎样设计一个简易物联网系统？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-other/物联网开发实战/04.进阶篇">04.进阶篇</a><ul><li><a href="/blog-other/物联网开发实战/04.进阶篇/01"><span>06 | 物模型：如何定义智能电灯？</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/02"><span>07 | 零配置组网：设备如何发现彼此？</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/03"><span>08 | MQTT：在实践中掌握一个通信协议</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/04"><span>09 | 边缘中心：物联网网关有多重要？</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/05"><span>10 | 数据处理框架：批处理还是流处理？</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/06"><span>11 | 数据存储：物联网中的数据库有哪些？</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/07"><span>12 | IoT Hub：面对海量设备如何打造高性能设备接入层？</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/08"><span>13 | 隐私：在实践中如何保护用户隐私？</span></a></li><li><a href="/blog-other/物联网开发实战/04.进阶篇/09"><span>14 | 安全：物联网平台如何应对安全风险？</span></a></li><li><a aria-current="page" class="active" href="/blog-other/物联网开发实战/04.进阶篇/10"><span>15 | 平台：智能家居开源平台的生态是怎样的？</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/05.实战篇">05.实战篇</a><ul><li><a href="/blog-other/物联网开发实战/05.实战篇/01"><span>16 | 实战准备：如何搭建硬件开发环境？</span></a></li><li><a href="/blog-other/物联网开发实战/05.实战篇/02"><span>17 | 远程控制：怎样打造联网的智能电灯？</span></a></li><li><a href="/blog-other/物联网开发实战/05.实战篇/03"><span>18 | 场景联动：智能电灯如何感知光线？（上）</span></a></li><li><a href="/blog-other/物联网开发实战/05.实战篇/04"><span>19 | 场景联动：智能电灯如何感知光线？（下）</span></a></li><li><a href="/blog-other/物联网开发实战/05.实战篇/05"><span>20 | 智能语音：好玩的语音控制是怎么实现的？</span></a></li><li><a href="/blog-other/物联网开发实战/05.实战篇/06"><span>21 | 多传感器集成：浇花怎么实现自动化？</span></a></li><li><a href="/blog-other/物联网开发实战/05.实战篇/07"><span>22 | 掌控数据：家里的数据可以怎么利用？</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/06.结束语">06.结束语</a><ul><li><a href="/blog-other/物联网开发实战/06.结束语/01"><span>结束语 | 永远做一个具有极客精神的人</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/07.测试题">07.测试题</a><ul><li><a href="/blog-other/物联网开发实战/07.测试题/01"><span>结课测试 | 这些物联网的问题，你都掌握了吗？</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/08.加餐">08.加餐</a><ul><li><a href="/blog-other/物联网开发实战/08.加餐/01"><span>加餐一 | 这5本关于物联网的好书，值得一读</span></a></li><li><a href="/blog-other/物联网开发实战/08.加餐/02"><span>加餐二 | 行业应用：物联网的发展将如何重塑我们的生活？</span></a></li><li><a href="/blog-other/物联网开发实战/08.加餐/03"><span>加餐三 | 行业应用：物联网的发展将如何升级第一、第二产业？</span></a></li><li><a href="/blog-other/物联网开发实战/08.加餐/04"><span>加餐四 | 5G技术将如何推动物联网的发展？</span></a></li><li><a href="/blog-other/物联网开发实战/08.加餐/05"><span>加餐五 | 投身物联网行业，如何做好职业规划？</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/09.用户故事">09.用户故事</a><ul><li><a href="/blog-other/物联网开发实战/09.用户故事/01"><span>用户故事 | 让野蛮生长成为职业发展的助推剂</span></a></li><li><a href="/blog-other/物联网开发实战/09.用户故事/02"><span>用户故事 | 转战物联网，我相信天道酬勤</span></a></li></ul></li><li><a href="/blog-other/物联网开发实战/summary">物联网开发实战</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="智能家居：生态开放" data-depth="2"><a href="/blog-other/物联网开发实战/04.进阶篇/10#智能家居生态开放"><span>智能家居：生态开放</span></a></li><li title="开源平台：方便定制" data-depth="2"><a href="/blog-other/物联网开发实战/04.进阶篇/10#开源平台方便定制"><span>开源平台：方便定制</span></a></li><li title="热度比较高的开源平台" data-depth="2"><a href="/blog-other/物联网开发实战/04.进阶篇/10#热度比较高的开源平台"><span>热度比较高的开源平台</span></a></li><li title="Gladys Assistant具体使用：动手实践" data-depth="2"><a href="/blog-other/物联网开发实战/04.进阶篇/10#gladys-assistant具体使用动手实践"><span>Gladys Assistant具体使用：动手实践</span></a></li><li title="第一步：准备器材" data-depth="3"><a href="/blog-other/物联网开发实战/04.进阶篇/10#第一步准备器材"><span>第一步：准备器材</span></a></li><li title="第二步：烧录系统镜像" data-depth="3"><a href="/blog-other/物联网开发实战/04.进阶篇/10#第二步烧录系统镜像"><span>第二步：烧录系统镜像</span></a></li><li title="第三步：启动系统" data-depth="3"><a href="/blog-other/物联网开发实战/04.进阶篇/10#第三步启动系统"><span>第三步：启动系统</span></a></li><li title="第四步：在Gladys Assistant上添加设备" data-depth="3"><a href="/blog-other/物联网开发实战/04.进阶篇/10#第四步在gladys-assistant上添加设备"><span>第四步：在Gladys Assistant上添加设备</span></a></li><li title="第五步：模拟MQTT设备" data-depth="3"><a href="/blog-other/物联网开发实战/04.进阶篇/10#第五步模拟mqtt设备"><span>第五步：模拟MQTT设备</span></a></li><li title="小结" data-depth="2"><a href="/blog-other/物联网开发实战/04.进阶篇/10#小结"><span>小结</span></a></li><li title="思考题" data-depth="2"><a href="/blog-other/物联网开发实战/04.进阶篇/10#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="15--平台智能家居开源平台的生态是怎样的"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#15--平台智能家居开源平台的生态是怎样的"><span class="icon icon-link"></span></a>15 | 平台：智能家居开源平台的生态是怎样的？</h1><p>你好，我是郭朝斌。</p><p>在学完了这门课程的前十几讲之后，你已经对物联网有了一个从整体到细节的全面了解。我想，你现在应该迫不及待地想要动手实践了吧？</p><p>在正式进入实战篇之前，我想以智能家居领域为例，带你了解一下开源平台。</p><h2 id="智能家居生态开放"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#智能家居生态开放"><span class="icon icon-link"></span></a>智能家居：生态开放</h2><p>为什么选择智能家居这个领域呢？最重要的原因当然是因为实战篇的动手项目是智能家居领域的。而另一个原因是，智能家居的生态环境比较开放，很有活力，而且也更贴近我们的日常生活。</p><p>在<a target="_blank" rel="noopener noreferrer" href="https://time.geekbang.org/column/article/313631">第9讲<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，我提到过和工业物联网相关的一些开源项目。相比之下，工业物联网领域更加封闭，如果不是行业从业人员，你很难理解它的功能需求。</p><p>那么，什么是平台，平台有什么用呢？就拿智能家居平台来说好了，它给各种智能家居产品提供了一个<strong>统一的接入系统</strong>，让用户可以<strong>管理</strong>和<strong>控制</strong>产品，同时也为各种智能家居产品之间的<strong>联动</strong>提供了条件。</p><p>如果没有智能家居平台，那么各种智能家居产品就是一个个孤立的单品，既不能远程控制，也不能实现联动功能。</p><p>如果你买过小米的智能产品，应该接触过小米的米家平台，它就是一个典型的智能家居平台。国内类似的还有阿里巴巴的天猫精灵、京东微联和海尔U+等。国外知名的智能家居平台有苹果的Apple HomeKit、亚马逊的Amazon Echo和谷歌的Google Home等。</p><h2 id="开源平台方便定制"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#开源平台方便定制"><span class="icon icon-link"></span></a>开源平台：方便定制</h2><p>不过，刚才提到的这些都是商业公司运营的平台，它们使用的技术和通信协议都是公司制定的，能够选择的产品也只能是已经接入平台的产品。作为开发实践者，我们可以定制的部分非常少。</p><p>所以在这一讲，我想介绍一下智能家居的开源平台生态。</p><p>一方面，开源平台能为你提供一个现成的基础，你可以在这个基础上快速地搭建出自己的智能家居系统。而且这些平台不但可以提供丰富的特性，一般也会提供各种定制能力，方便你基于自己的需求灵活地调整。</p><p>另一方面，就算你在工作中不直接使用这些开源平台，你也可以从它们的架构设计和实现逻辑中汲取灵感。</p><p>在介绍完智能家居的开源生态之后，我还会选择其中一个开源平台，带你在树莓派开发板上运行起来，这样你也可以初步体验一下智能家居软件。</p><h2 id="热度比较高的开源平台"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#热度比较高的开源平台"><span class="icon icon-link"></span></a>热度比较高的开源平台</h2><p>那么你觉得智能家居的开源平台多吗？我告诉你，其实非常多。这也从侧面反映出智能家居是一个非常被看好的领域。</p><p>在这一讲中，把所有的开源项目都讲一遍是不现实的，所以我精心挑选了5个热度比较高的项目介绍，供你参考。</p><ol><li><h4 id="home-assistant"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#home-assistant"><span class="icon icon-link"></span></a>Home Assistant</h4></li></ol><p>首先要说的就是<a target="_blank" rel="noopener noreferrer" href="https://www.home-assistant.io/">Home Assistant<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。由于支持丰富的硬件和软件组件，能够实现自由灵活的配置和定制开发，所以它是现在热度最高的开源平台。大量极客用户组成了庞大而活跃的社群，他们贡献了很多基于Home Assistant的开源组件和丰富的使用资料。</p><p>这些组件要怎么配置呢？在Home Assistant中，你需要通过configuration.yaml配置文件来定义你需要使用的组件以及组件之间的联动方式等。</p><p>从文件的扩展名你应该可以看出，它的配置文件使用的是<a target="_blank" rel="noopener noreferrer" href="https://yaml.org/">YAML语言<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。这种语言是专门为配置文件设计的，写起来比JSON要简单得多。</p><p>另外，Home Assistant是基于Python 3语言实现的，理论上支持在任何有Python 3的系统环境中运行，当然也包括树莓派。它对于树莓派的支持非常好。</p><p>虽然是开源软件，但是我们也需要注意开源许可协议。Home Assistant的代码采用的是<a target="_blank" rel="noopener noreferrer" href="https://github.com/home-assistant/core/blob/master/LICENSE.md">Apache License 2.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>协议。</p><ol start="2"><li><h4 id="domoticz"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#domoticz"><span class="icon icon-link"></span></a>Domoticz</h4></li></ol><p>第2个要讲的是<a target="_blank" rel="noopener noreferrer" href="https://www.domoticz.com/">Domoticz<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，它是一个开源的家居自动化平台，可以帮你实现对智能家居设备和传感器的控制和监测等目的。除了它原生支持的设备，你还可以使用很多开源插件。当然，你也可以选择用Python语言开发自己的插件，从而支持自己特有的设备。</p><p>Domoticz主要是通过Web界面来进行自定义和配置。它还同时提供了iOS和Android两大系统的App供你查看和控制设备。</p><p>Domoticz是基于C++语言开发的。跟Python语言开发的软件不同，它还需要编译不同的安装包，这显然不够方便。不过，Domoticz官方已经为Windows和Linux系统准备了二进制安装包，包括使用ARM架构芯片的树莓派，也已经有了编译好的可执行文件。</p><p>Domoticz代码采用的是<a target="_blank" rel="noopener noreferrer" href="https://github.com/domoticz/domoticz/blob/master/License.txt">GNU General Public License v3.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（GPLv3）开源协议。</p><ol start="3"><li><h4 id="openhab"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#openhab"><span class="icon icon-link"></span></a>openHAB</h4></li></ol><p>第3个要讲的是openHAB。它的出发点是提供一个家庭自动化的总线，所以在设计上尽量抽象而模糊设备本身，便于你根据需求添加设备和插件。在openHAB中，插件是通过Bindings来实现设备和openHAB内核的交换信息的。</p><p>交互界面方面，openHAB也提供了丰富的选择，包括原生的iOS和Android平台的App以及Web页面和Windows 10应用程序等。</p><p>openHAB是基于Java语言开发的。除了常见的电脑平台，它还支持用Docker镜像的方式安装使用。另外，它还专门提供了openHABian系统的镜像文件，所以在树莓派上使用openHAB软件是非常方便的。</p><p>openHAB代码采用的是<a target="_blank" rel="noopener noreferrer" href="https://github.com/openhab/openhab-core/blob/master/LICENSE">Eclipse Public License 2.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>开源协议。</p><ol start="4"><li><h4 id="gladys-assistant"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#gladys-assistant"><span class="icon icon-link"></span></a>Gladys Assistant</h4></li></ol><p>第4个要讲的是<a target="_blank" rel="noopener noreferrer" href="https://gladysassistant.com/en/">Gladys Assistant<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。它是一个刚刚重新设计和开发的智能家居平台。它原生支持Z-Wave、MQTT和小米等设备接口，并且在平台中嵌入了自己的 NLP（自然语言处理）对话引擎。你可以在平台上定义复杂的场景模式。</p><p>Gladys Assistant的主要交互界面是Web页面。不过这些Web界面在手机上的体验也非常好，因为它是基于PWA（Progressive Web App）实现的。PWA技术使Web应用在手机的体验基本和原生App一致。</p><p>Gladys Assistant使用JavaScript语言实现的。它对于树莓派的支持非常不错，提供了基于Raspbian的系统镜像。另外，通过Docker的方式对MacOS和Windows系统也提供了支持。</p><p>Gladys Assistant代码采用的是 <a target="_blank" rel="noopener noreferrer" href="https://github.com/GladysAssistant/Gladys/blob/master/LICENSE">Apache License 2.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>开源协议。</p><ol start="5"><li><h4 id="webthingsio"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#webthingsio"><span class="icon icon-link"></span></a>WebThingsIO</h4></li></ol><p>不知道你是否还记得，我在加餐的书单推荐中提到过<a target="_blank" rel="noopener noreferrer" href="https://www.w3.org/WoT/">WoT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>标准。这里我要介绍的<a target="_blank" rel="noopener noreferrer" href="https://iot.mozilla.org/">WebThingsIO<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>项目正是Mozilla在领导开发的一个基于WoT理念的开源实现。</p><p>其中，WebThings Gateway是一个智能家居网关软件（也就是控制中心）实现，你可以使用它提供的Web界面来实现对设备的查看和控制。它也支持定义联动的规则，还提供了用插件方式来扩展对其他设备的支持。</p><p>WebThings Gateway主要是使用JavaScript语言实现的。它为树莓派专门制作了系统镜像文件，你可以直接烧录使用。对于常用的Linux系统，也可以直接通过软件包管理器安装使用。</p><p>WebThings Framework是一个软件组件集合，你可以基于这些组件来开发支持<a target="_blank" rel="noopener noreferrer" href="https://iot.mozilla.org/wot/">Web Thing API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的硬件设备。它有不同的编程语言实现，包括Node.js、Python（包括MicroPython）、Java、Rust、C++（Arduino实现）。</p><p>WebThingsIO的代码采用的是<a target="_blank" rel="noopener noreferrer" href="https://github.com/WebThingsIO/gateway/blob/master/LICENSE">Mozilla Public License 2.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>开源协议。</p><p>这里，我把这5个开源的智能家居平台的特性总结为一个表格，方便你随时参考。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage3f6a3f957676a982afacb7619925ed19986a.2c00d285.jpg" alt=""/></p><h2 id="gladys-assistant具体使用动手实践"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#gladys-assistant具体使用动手实践"><span class="icon icon-link"></span></a>Gladys Assistant具体使用：动手实践</h2><p>这5个比较有代表性的智能家居开源平台，对于树莓派的支持都不错的。现在，我们就开始动手，在树莓派上安装一个开源平台，体验一下通过智能家居系统监测设备数值的过程。</p><p>使用哪个平台呢？我们就选择Gladys Assistant吧。它的优势是Web页面在手机上体验不错，不需要你去搜索或者编译手机上的App了。</p><p>其他几个开源平台的安装和使用方法都差不多。你掌握了一个，那么利用镜像文件安装其他几个也不成问题。</p><h3 id="第一步准备器材"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#第一步准备器材"><span class="icon icon-link"></span></a>第一步：准备器材</h3><p>首先我介绍一下需要准备的器材有哪些：</p><ol><li><strong>树莓派Raspberry Pi 4B</strong>，要求内存2GB以上，但是8GB内存版本要谨慎选择，因为有些开源平台软件对Arm 64bit芯片支持不够好。</li><li><strong>供电电源</strong>，要求支持3A以上电流。</li><li><strong>Micro SD卡</strong>，也叫TF卡，存储容量最好在16GB以上。在选择的时候，你要关注读写速度等级，比如U3表示最低写入速度是30MB/s。同时你也要关注<a target="_blank" rel="noopener noreferrer" href="https://www.sdcard.org/chs/developers/overview/application/index.html">应用性能等级<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，它定义了Micro SD卡进行随机读写的性能，最好是选择Application Performance Class 2（卡面上标识A2图标）。在卡上存储应用程序和应用程序数据时，这个性能指标非常重要。</li></ol><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagef466f4928d8a87bde8b4e235b8cdf057d266.e40f96dc.jpg" alt=""/></p><ol start="4"><li><strong>Micro SD卡读卡器</strong>。有些电脑自带这个接口，如果没有的话，你可以买一个便宜的使用。</li><li><strong>普通网线</strong>。如果你希望以有线的方式使用树莓派，可以准备一根。同时，我也会介绍树莓派接入Wi-Fi的方式。</li></ol><h3 id="第二步烧录系统镜像"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#第二步烧录系统镜像"><span class="icon icon-link"></span></a>第二步：烧录系统镜像</h3><p>树莓派板子在启动的时候，会从SD卡读取操作系统镜像文件，完成操作系统的引导启动工作。所以我们接下来要在SD卡上烧录系统镜像。</p><p>具体怎么烧录呢？我们可以使用一个免费的烧录工具，<strong>Etcher</strong>。它支持MacOS、Windows和Linux三种主流的电脑系统，你可以从<a target="_blank" rel="noopener noreferrer" href="https://etcher.io/">官方网站<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上下载和安装。也可以点击<a target="_blank" rel="noopener noreferrer" href="https://github.com/balena-io/etcher/releases">这个链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>下载最新版。</p><p>然后，下载树莓派的系统镜像文件。树莓派有官方的操作系统镜像 Raspbian可以选择，但是为了避免手动在 Raspbian系统中安装 Gladys Assistant 软件的麻烦，我们直接选择官方提供的已经配置好Gladys Assistant的Raspbian镜像文件。</p><p>从<a target="_blank" rel="noopener noreferrer" href="https://cdn.elephantcdn.com/gh/gladysassistant/gladys/releases/download/v4.0.0/gladys-4.0.0-rev3.img.zip">这个链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中下载好镜像文件，并且解压缩得到&quot;img&quot;扩展名的文件。然后把Micro SD卡插入读卡器，或者直接插入你的电脑接口中。运行Etcher软件，按照步骤把镜像文件烧录到存储卡中。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage1b731bcbb300760c8febe63898a0174c3273.ea6f092b.png" alt=""/></p><p>树莓派支持网线接口，不过，如果你希望树莓派接入家里的Wi-Fi热点，而不是使用网线访问网络，那么就需要在Micro SD卡中增加一个配置文件。</p><p>这个配置文件的文件名必须是wpa_supplicant.conf。你可以在电脑上使用自己熟悉的文本编辑器创建这个文件，并且在文件中输入下面的内容：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span></div><div class="token-line"><span class="token plain">    update_config=1</span></div><div class="token-line"><span class="token plain">    country=CN</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    network={</span></div><div class="token-line"><span class="token plain">     ssid=&quot;你的Wi-Fi热点SSID名称&quot;</span></div><div class="token-line"><span class="token plain">     psk=&quot;你的Wi-Fi热点密码&quot;</span></div><div class="token-line"><span class="token plain">     key_mgmt=WPA-PSK</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>注意，将Wi-Fi热点的SSID和密码替换为你家里的Wi-Fi路由器的真实情况。</p><p>然后将这个文件拷贝到Micro SD卡的根目录。这时，你就可以把Micro SD卡插入树莓派开发板了。</p><h3 id="第三步启动系统"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#第三步启动系统"><span class="icon icon-link"></span></a>第三步：启动系统</h3><p>烧录好镜像文件，准备好Micro SD卡后，你可以把Micro SD卡从读卡器取出，插入树莓派的对应接口中。</p><p>接着，接上电源线（如果你使用网线方式，记得也将网线接入树莓派板的网口上）。这时树莓派将自动启动运行，需要等待一段时间。</p><p>过一会儿之后，在你的电脑上，打开浏览器，输入 &quot;<a target="_blank" rel="noopener noreferrer" href="http://gladys.local/">http://gladys.local<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot; 来访问树莓派上的Gladys Assistant系统，如下图所示。</p><p>如果你使用的电脑系统是比较老的Windows版本，可能无法通过这种方式访问树莓派，而是需要将“gladys.local”替换为树莓派的IP地址。</p><p>怎么获取到树莓派的IP地址呢？你可以使用一些网络分析软件，比如Android手机上安装Network Scanner，iOS手机上安装iNet来扫描网络。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage60cf600490ac2f908cb13ce81b379a8fdacf.26977771.png" alt=""/></p><p>那么，为什么不给树莓派接一个显示器，而要通过你的电脑上的浏览器来访问呢？这是因为Gladys Assistant 为了简化镜像，没有提供可视化的桌面环境。其实你只要熟悉了操作方法，就会发现这样的设计是非常方便的，因为你不需要为树莓派再准备个显示器了。</p><h3 id="第四步在gladys-assistant上添加设备"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#第四步在gladys-assistant上添加设备"><span class="icon icon-link"></span></a>第四步：在Gladys Assistant上添加设备</h3><p>因为我们是第一次配置Gladys Assistant，所以要在上面的页面中选择“Create local account with your Email”，来创建一个本地账号。</p><p>创建完账号后，其他的步骤不是必填项，你根据喜好填写就行了。房屋配置部分，你可以创建一个名称为bedroom的房间，后面会用到。最后，你应该可以看到这个Dashboard页面。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage143a14de681771577c2b8d56fc3590f12d3a.2c08e6a6.png" alt=""/></p><p>接下来，我们来添加一个设备，来体验一下Gladys Assistant的功能。</p><p>那么，添加什么设备呢？我们还没有讲到实战篇的具体项目呢。不过，我们可以用电脑来模拟一个设备。你还记得第8讲介绍的MQTT协议吗？Gladys Assistant系统支持MQTT通信协议的设备。所以，我们可以通过电脑终端的命令行来模拟一个设备，发送MQTT消息给Gladys Assistant，让Gladys Assistant来展示这个设备。</p><p>首先，我们在Gladys Assistant上准备MQTT Broker。选择Dashboard 上部的标签页“Integrations”，点击MQTT标签。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagea2aba2f23d7ce6f2e95d557dce9c93481dab.c51f6a60.png" alt=""/></p><p>进入MQTT设置界面后，你现在需要点击左边的Setup，开始安装MQTT Broker。我们通过默认选项，即使用Docker的方式来完成。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagece1ace2016b8d4ee5ed95e91856a04f44d1a.aa84853c.png" alt=""/></p><p>这个过程需要几分钟时间。完成后，你就可以看到MQTT Broker的用户名和密码。我将密码改成了geektimetest，为了便于记忆，你也可以选择一个自己的密码。同时，你需要将用户名和密码记录下来，因为后面模拟设备发送MQTT消息时会用到。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage528952d0ccc87753ea79c670d8d5b798dd89.8f51b548.png" alt=""/></p><p>接着，我们点击左边的Device，切换到MQTT设备页面。点击右上角的New打开创建页面。设备名称我们可以选择Temperature Sensor，External ID填写mqtt:bedroom:temperature-sensor。字符串中bedroom是和下一项房间填写的信息一致的。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage55d6554e038f3a7a7f8e2bbd3c14632269d6.271c83f6.png" alt=""/></p><p>然后，我们为设备添加特性（Features）。这里，我们选择Temperature 类型。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagee8dbe8f806569bf36852abe3712c6fed5fdb.90c0418c.png" alt=""/></p><p>选择完类型后，我们点击Add feature，开始设置具体的特性参数。你可以按照下图的内容来设置自己的参数。其中，external ID填写mqtt:bedroom:temperature-sensor:temperature字符串。最下面的MQTT Topic，你需要记录下来，后面发送消息时需要用到。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagea0aea03735551ee3e3124131169c1b4d60ae.16da67ea.png" alt=""/></p><p>点击下部的保存（Save）和返回（Back），然后我们可以看到创建完成的MQTT设备。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagecce2cc37b26e8d548465a4c3aa1dba87a1e2.e4db8f9c.png" alt=""/></p><p>在模拟发送MQTT消息之前，我们还需要编辑一下Dashboard界面。你需要点击左上角切换回Home标签页，然后点击右上角的Edit按键。在编辑界面的Column 1 选择Devices in room类别。然后依次选择bedroom和我们刚创建的设备Temperature Sensor传感器。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage2e9e2e2bd7fyyaa7ba7b7eb79026db90f89e.ec13902e.png" alt=""/></p><p>点击页面右下角的Save，保存Dashboard的编辑界面。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage160716ca1f18eb80eb0fd2efd37d04a49c07.859bbd41.png" alt=""/></p><p>当然，现在传感器没有数值显示。</p><h3 id="第五步模拟mqtt设备"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#第五步模拟mqtt设备"><span class="icon icon-link"></span></a>第五步：模拟MQTT设备</h3><p>接下来，我们打开一个终端命令窗口，输入下面的命令：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">hbmqtt_pub -d --url mqtt://gladys:geektimetest@gladys.local:1883 -t gladys/master/device/mqtt:bedroom:temperature-sensor/feature/mqtt:bedroom:temperature-sensor:temperature/state -m 25.2</span></div></pre></div><p>其中，gladys:geektimetest是用户名和密码，它们以分号相连。gladys.local是树莓派的域名。-t后面的消息主题就是你刚才记录的MQTT Topic字符串。-m后面是温度数值。</p><p>执行这个命令后，你再打开Gladys Assistant的Dashboard界面，这时你就可以看到设备卡片显示出来了刚才发送的温度数值。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagec94dc931174c7c4dd9cafde673ee795bf24d.3b8e36bf.png" alt=""/></p><h2 id="小结"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#小结"><span class="icon icon-link"></span></a>小结</h2><p>总结一下，在这一讲中，我介绍了智能家居开源平台的生态，并且带你动手在树莓派上安装了Gladys Assistant，然后体验了一下使用过程。</p><ol><li>智能家居平台为各种智能家居产品提供了一个统一的接入系统，让用户可以管理和控制产品，同时也为各种智能家居产品之间的联动提供了条件。</li><li>了解开源的智能家居平台有两大好处，一是你可以基于它们快速地搭建智能家居系统，另一个是你可以在工作中借鉴它们的设计思想和架构。</li><li>开源的智能家居平台有很多，热度比较高的平台有5个，分别是Home Assistant、Domoticz、openHAB、Gladys Assistant 和WebThingsIO。</li><li>利用开源平台，在树莓派开发板上搭建智能家居系统的一般步骤包括：准备器材，烧录系统镜像，启动系统，添加设备，接收和显示设备信息等。</li></ol><p>在实战篇，等你掌握了开发智能硬件的基本方法，可以将这一讲中的模拟设备替换为真实的温度传感器设备。期待你的动手实践。</p><p>而且之后，等你熟悉树莓派开发板的使用方法，你也可以在树莓派上尝试一下其它几个开源平台。它们的基本功能都比较接近，你可以根据自己喜好，或者熟悉的编程语言选择。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog-other/物联网开发实战/04.进阶篇/10#思考题"><span class="icon icon-link"></span></a>思考题</h2><p>最后，我给你留一个思考题吧。</p><p>在这一讲的动手实验环节，我们是通过访问<a target="_blank" rel="noopener noreferrer" href="http://gladys.local/">http://gladys.local<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来查看Gladys Assistant的Dashboard等Web应用界面的。为什么我们可以通过gladys.local 域名来访问树莓派开发板呢？为什么有的老版本电脑系统不支持呢？这是使用了什么网络协议？</p><p>欢迎你在留言区写一写自己的答案，也欢迎你将这一讲分享给对智能家居 DIY感兴趣的朋友，大家一起交流学习。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/物联网开发实战/04.进阶篇/10.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/23 21:58:31</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-other/umi.js"></script>
  </body>
</html>
