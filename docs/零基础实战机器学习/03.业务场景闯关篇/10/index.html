<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-other/umi.css" />
    <script>
      window.routerBase = "/blog-other";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>14｜留存分析：哪些因素会影响用户的留存率？ - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/零基础实战机器学习/03.业务场景闯关篇/10" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-other/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>前端开发<ul><li><a href="/blog-other/说透低代码">说透低代码</a></li><li><a href="/blog-other/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li></ul></span><span>产品与用户体验<ul><li><a href="/blog-other/大厂广告产品心法">大厂广告产品心法</a></li></ul></span><span>面试<ul><li><a href="/blog-other/技术面试官识人手册">技术面试官识人手册</a></li><li><a href="/blog-other/面试现场">面试现场</a></li></ul></span><span>杂谈<ul><li><a href="/blog-other/乔新亮的cto成长复盘">乔新亮的cto成长复盘</a></li><li><a href="/blog-other/互联网人的英语私教课">互联网人的英语私教课</a></li><li><a href="/blog-other/从0开始学游戏开发">从0开始学游戏开发</a></li><li><a href="/blog-other/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog-other/手机摄影">手机摄影</a></li><li><a href="/blog-other/物联网开发实战">物联网开发实战</a></li><li><a href="/blog-other/白话法律42讲">白话法律42讲</a></li><li><a href="/blog-other/说透5g">说透5g</a></li><li><a href="/blog-other/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a aria-current="page" class="active" href="/blog-other/零基础实战机器学习">零基础实战机器学习</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-other/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>前端开发<ul><li><a href="/blog-other/说透低代码">说透低代码</a></li><li><a href="/blog-other/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li></ul></li><li>产品与用户体验<ul><li><a href="/blog-other/大厂广告产品心法">大厂广告产品心法</a></li></ul></li><li>面试<ul><li><a href="/blog-other/技术面试官识人手册">技术面试官识人手册</a></li><li><a href="/blog-other/面试现场">面试现场</a></li></ul></li><li>杂谈<ul><li><a href="/blog-other/乔新亮的cto成长复盘">乔新亮的cto成长复盘</a></li><li><a href="/blog-other/互联网人的英语私教课">互联网人的英语私教课</a></li><li><a href="/blog-other/从0开始学游戏开发">从0开始学游戏开发</a></li><li><a href="/blog-other/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog-other/手机摄影">手机摄影</a></li><li><a href="/blog-other/物联网开发实战">物联网开发实战</a></li><li><a href="/blog-other/白话法律42讲">白话法律42讲</a></li><li><a href="/blog-other/说透5g">说透5g</a></li><li><a href="/blog-other/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a aria-current="page" class="active" href="/blog-other/零基础实战机器学习">零基础实战机器学习</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-other/零基础实战机器学习">零基础实战机器学习</a></li><li><a href="/blog-other/零基础实战机器学习/01.开篇词">01.开篇词</a><ul><li><a href="/blog-other/零基础实战机器学习/01.开篇词/01"><span>开篇词｜开发者为什么要从实战出发学机器学习？</span></a></li></ul></li><li><a href="/blog-other/零基础实战机器学习/02.准备篇">02.准备篇</a><ul><li><a href="/blog-other/零基础实战机器学习/02.准备篇/01"><span>01｜打好基础：到底什么是机器学习？</span></a></li><li><a href="/blog-other/零基础实战机器学习/02.准备篇/02"><span>02｜工具准备：安装并使用Jupyter Notebook</span></a></li><li><a href="/blog-other/零基础实战机器学习/02.准备篇/03"><span>03｜实战5步（上）：怎么定义问题和预处理数据？</span></a></li><li><a href="/blog-other/零基础实战机器学习/02.准备篇/04"><span>04｜ 实战5步（下）：怎么建立估计10万+软文点击率的模型？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇">03.业务场景闯关篇</a><ul><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/01"><span>05 | 数据探索：怎样从数据中找到用户的RFM值？</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/02"><span>06 | 聚类分析：如何用RFM给电商用户做价值分组画像？</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/03"><span>07｜回归分析：怎样用模型预测用户的生命周期价值？</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/04"><span>08 | 模型优化（上）：怎么用特征工程提高模型效率？</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/05"><span>09｜模型优化（中）：防止过拟合，模型也不能太精细</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/06"><span>10｜模型优化（下）：交叉验证，同时寻找最优的参数</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/07"><span>11｜深度学习（上）：用CNN带你认识深度学习</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/08"><span>12｜深度学习（中）：如何用RNN预测激活率走势？</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/09"><span>13｜深度学习（下）：3招提升神经网络预测准确率</span></a></li><li><a aria-current="page" class="active" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10"><span>14｜留存分析：哪些因素会影响用户的留存率？</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/11"><span>15｜二元分类：怎么预测用户是否流失？从逻辑回归到深度学习</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/12"><span>16｜性能评估：不平衡数据集应该使用何种评估指标？</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/13"><span>17｜集成学习：机器学习模型如何“博采众长”?</span></a></li><li><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/14"><span>18 | 增长模型：用XGBoost评估裂变海报的最佳受众群体</span></a></li></ul></li><li><a href="/blog-other/零基础实战机器学习/04.持续赋能篇">04.持续赋能篇</a><ul><li><a href="/blog-other/零基础实战机器学习/04.持续赋能篇/01"><span>19 | 胸有成竹：如何快速定位合适的机器学习算法？</span></a></li><li><a href="/blog-other/零基础实战机器学习/04.持续赋能篇/02"><span>20 | 模型部署：怎么发布训练好的机器学习模型？</span></a></li><li><a href="/blog-other/零基础实战机器学习/04.持续赋能篇/03"><span>21｜持续精进：如何在机器学习领域中找准前进的方向？</span></a></li></ul></li><li><a href="/blog-other/零基础实战机器学习/05.结束语">05.结束语</a><ul><li><a href="/blog-other/零基础实战机器学习/05.结束语/01"><span>一套习题，测出你对机器学习的掌握程度</span></a></li><li><a href="/blog-other/零基础实战机器学习/05.结束语/02"><span>结束语 | 可以不完美，但重要的是马上开始</span></a></li></ul></li><li><a href="/blog-other/零基础实战机器学习/summary">零基础实战机器学习</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="定义问题" data-depth="2"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#定义问题"><span>定义问题</span></a></li><li title="数据的预处理" data-depth="2"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#数据的预处理"><span>数据的预处理</span></a></li><li title="1. 数据导入" data-depth="3"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#1-数据导入"><span>1. 数据导入</span></a></li><li title="2. 数据清洗" data-depth="3"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#2-数据清洗"><span>2. 数据清洗</span></a></li><li title="3. 数据可视化" data-depth="3"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#3-数据可视化"><span>3. 数据可视化</span></a></li><li title="4. 特征工程" data-depth="3"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#4-特征工程"><span>4. 特征工程</span></a></li><li title="Kaplan-Meier生存模型：显示整体留存曲线" data-depth="2"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#kaplan-meier生存模型显示整体留存曲线"><span>Kaplan-Meier生存模型：显示整体留存曲线</span></a></li><li title="Cox危害系数模型：预测用户留存概率" data-depth="2"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#cox危害系数模型预测用户留存概率"><span>Cox危害系数模型：预测用户留存概率</span></a></li><li title="1. 数据预处理" data-depth="3"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#1-数据预处理"><span>1. 数据预处理</span></a></li><li title="2. 创建并拟合模型" data-depth="3"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#2-创建并拟合模型"><span>2. 创建并拟合模型</span></a></li><li title="3. 显示留存概率曲线" data-depth="3"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#3-显示留存概率曲线"><span>3. 显示留存概率曲线</span></a></li><li title="Cox危害系数模型：分析影响留存的因子" data-depth="2"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#cox危害系数模型分析影响留存的因子"><span>Cox危害系数模型：分析影响留存的因子</span></a></li><li title="总结一下" data-depth="2"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#总结一下"><span>总结一下</span></a></li><li title="思考题" data-depth="2"><a href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="14留存分析哪些因素会影响用户的留存率"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#14留存分析哪些因素会影响用户的留存率"><span class="icon icon-link"></span></a>14｜留存分析：哪些因素会影响用户的留存率？</h1><p>你好，我是黄佳。欢迎你来到零基础实战机器学习，今天我们正式开启留存关。</p><p>在开启这一关之前，我想给你讲一个小时候的故事。这是70年代人的回忆了，那时候，小学的校门口有两家租“小人书”摊，一毛钱看一本。小人书，就是一大堆的64开小画本，里面是西游记、水浒传、封神榜、射雕英雄传啥的。</p><p>两家的小人书其实都差不多的，那个年代也没有玄幻，也没有网络写手。可是呢，A家的生意总比B家好，我一开始不知道怎么回事，后来我想起 A家的老板记忆力很好，他总能记住我们这些孩子谁是谁，而且他每次都和我们说：“看五本送一本哈！”如果我们看了三本，他就会说：“下回再看两本就多送一本免费的。”</p><p>多年以后，我恍然大悟，原来老板在30年前就建立起了买5送一和老客户会员卡的制度。只不过他是凭借自己的记忆力来完成的。正是由于这个原因，A老板的用户留存率比较高。</p><p>什么是用户留存？留存就是让老用户一直使用你的产品。其实，谈留存，就不能不提另外一个关键概念“流失”。用户的留存和流失，是阴和阳的两极，此消彼长。收集和分析用户行为数据，有助于我们摸清用户是“留”还是“失”之间的微妙门道。</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage958b955848c6394c66812c9a29d87d2d828b.ac9766af.jpg" alt=""/></p><p>那么，今天这节课我们就通过机器学习模型来显示易速鲜花的会员留存曲线，并且分析“易速鲜花”会员卡中设置的哪些机制，是对会员留存影响比较大的因子，哪些又容易造成用户的流失。学习了这些，你就掌握了一组非常实用的运营分析工具，这对于如何留客有很大的指导意义。</p><h2 id="定义问题"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#定义问题"><span class="icon icon-link"></span></a>定义问题</h2><p>现在，让我们回到易速鲜花公司的运营部，一起为提升“易速鲜花”的用户留存率而奋斗。易速鲜花其实已经建立起了一套完善的会员机制，来增加用户的黏性。不过，运营部门的老总不确定的是，在一系列的促销套餐和会员卡类型中，哪些因素和用户的留存关系更为密切。</p><p>你从运营那边拿到了这样的<a target="_blank" rel="noopener noreferrer" href="https://github.com/huangjia2019/geektime/tree/main/%E7%95%99%E5%AD%98%E5%85%B314">数据集<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagec48ac44ac391fb773b147bd5e80f2c3d678a.a73df6b5.png" alt=""/></p><p>在这个数据集中，有下面一系列的字段：</p><ul><li>用户码；</li><li>性别；</li><li>一系列的会员专享套餐优惠，包括玫瑰套餐、紫罗兰套餐、郁金香套餐、百合套餐、康乃馨套餐、胡姬花套餐、生日套餐、情人节套餐等，这个是注册会员时，随机赠送给会员的；</li><li>会员卡的类型；</li><li>入会月数 ；</li><li>会费支付方式；</li><li>平均月消费；</li><li>总消费；</li><li>是否已停付会费。</li></ul><p>我们今天的目标呢，就是从这个数据中找出，哪些因素和用户的留存关系更为密切，哪些因素可能会导致老用户的流失。而这个问题，既不是一个回归问题，也不是一个分类问题，它是一个数据探索类型的问题。</p><p>对于这个问题，首先，我们要做的仍然是数据集的导入，数据清洗，以及简单的可视化工作。</p><h2 id="数据的预处理"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#数据的预处理"><span class="icon icon-link"></span></a>数据的预处理</h2><h3 id="1-数据导入"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#1-数据导入"><span class="icon icon-link"></span></a>1. 数据导入</h3><p>数据集我们已经有了，你在<a target="_blank" rel="noopener noreferrer" href="https://github.com/huangjia2019/geektime/tree/main/%E7%95%99%E5%AD%98%E5%85%B314">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>可以下载到。现在，第一步是导入必须的库，并载入数据集。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import numpy as np #导入NumPy</span></div><div class="token-line"><span class="token plain">    import pandas as pd #导入Pandas</span></div><div class="token-line"><span class="token plain">    df_member = pd.read_csv(&#x27;易速鲜花会员留存.csv&#x27;) #载入数据集</span></div><div class="token-line"><span class="token plain">    df_member.head() #显示数据头几行</span></div></pre></div><p>输出如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagedcb7dca4a5f6c3b2739ea33b7c4daa5da3b7.1b9d8e69.png" alt=""/></p><p>从输出中，我们看到这个数据集一共有7043条易速鲜花会员的数据。下面我们就开始做数据清洗的工作。</p><h3 id="2-数据清洗"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#2-数据清洗"><span class="icon icon-link"></span></a>2. 数据清洗</h3><p>我们先用describe方法看一看这个数据集。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">df_member.describe() # 显示数据集数值字段概率</span></div></pre></div><p>输出如下：</p><p><img src="data:image/png;base64,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" alt=""/></p><p>不知道你有没有观察到一个有意思的事儿，就是这个describe方法把用户码当成了数值性数据（这也难免，因为这里的用户码是数字编号）。此外，这个表格中没有“总消费”这个字段。我推测“总消费”这个字段有点问题，它有可能看起来是数值，但是实际的格式是字符串。</p><p>我用is_numeric_dtype方法验证一下我的推测，这个方法会显示一个字段是否为数值类型。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">from pandas.api.types import is_numeric_dtype #导入is_numeric_dtype工具</span></div><div class="token-line"><span class="token plain">    is_numeric_dtype(df_member[&#x27;总消费&#x27;]) #是否为数值字段？</span></div></pre></div><p>输出显示：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">False</span></div></pre></div><p>果然，“总消费”这个字段的格式有问题，目前它并不是一个数值字段，只是看起来像是数值的字符串。这里我们用to_numeric这个API对它做个转换：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">df_member[&#x27;总消费&#x27;] = pd.to_numeric(df_member[&#x27;总消费&#x27;], errors=&#x27;coerce&#x27;) #把总消费字段转换成数值字段</span></div><div class="token-line"><span class="token plain">    df_member[&#x27;总消费&#x27;].fillna(0, inplace=True) #补充0值</span></div></pre></div><p>然后，我们再用is_numeric_dtype验证，就会得到输出结果True，这说明“总消费”字段的格式成功转换成了“数值型”。</p><h3 id="3-数据可视化"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#3-数据可视化"><span class="icon icon-link"></span></a>3. 数据可视化</h3><p>在数据可视化这个部分，我们通过饼图来看一看性别、会费支付方式、会员卡类型、已停付会费这四个字段的分布比例。这些分布情况，尤其是留存与流失的会员占比，对于我们确定当前运营的重点关注点很有指导意义。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import matplotlib.pyplot as plt #导入绘图工具</span></div><div class="token-line"><span class="token plain">    plt.figure(figsize=(10,8)) #图片大小</span></div><div class="token-line"><span class="token plain">    plt.subplot(2, 2, 1) #子图1</span></div><div class="token-line"><span class="token plain">    ax = df_member.groupby(&#x27;性别&#x27;).count()[&#x27;用户码&#x27;].plot.pie(autopct=&#x27;%1.0f%%&#x27;) #饼图1</span></div><div class="token-line"><span class="token plain">    plt.subplot(2, 2, 2) #子图2</span></div><div class="token-line"><span class="token plain">    ax = df_member.groupby(&#x27;会费支付方式&#x27;).count()[&#x27;用户码&#x27;].plot.pie(autopct=&#x27;%1.0f%%&#x27;) #饼图2</span></div><div class="token-line"><span class="token plain">    plt.subplot(2, 2, 3) #子图3</span></div><div class="token-line"><span class="token plain">    ax = df_member.groupby(&#x27;会员卡类型&#x27;).count()[&#x27;用户码&#x27;].plot.pie(autopct=&#x27;%1.0f%%&#x27;) #饼图3</span></div><div class="token-line"><span class="token plain">    plt.subplot(2, 2, 4) #子图4</span></div><div class="token-line"><span class="token plain">    ax = df_member.groupby(&#x27;已停付会费&#x27;).count()[&#x27;用户码&#x27;].plot.pie(autopct=&#x27;%1.0f%%&#x27;) #饼图4</span></div><div class="token-line"><span class="token plain">    plt.show() #显示</span></div></pre></div><p>输出如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagea1a2a169982d2bc27669498423a3a92cb0a2.164b511b.png" alt=""/></p><p>当然，这些信息，其实你也可以通过柱状图来显示。在上面这张图中，我希望你注意一下右下角“已停付会费”这个分布图，因为它能直接体现出我们的用户是否流失，而用户是否流失就是我们的标签。</p><p>下面，我们开始做一些特征工程，以确保所有字段都能被机器学习模型处理。</p><h3 id="4-特征工程"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#4-特征工程"><span class="icon icon-link"></span></a>4. 特征工程</h3><p>我们再来看看这个数据集：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagedcb7dca4a5f6c3b2739ea33b7c4daa5da3b7.1b9d8e69.png" alt=""/></p><p>在这个数据集中，最后一列“已停付会费”字段显示有一些用户已流失。目前这个字段的值的类型是汉字，我们需要转换为0、1值才能被模型读入。同理，我们对“性别”字段也做类似处理。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain"># 把汉字转换成0、1值</span></div><div class="token-line"><span class="token plain">    df_member[&#x27;已停付会费&#x27;].replace(to_replace=&#x27;是&#x27;, value=1, inplace=True)</span></div><div class="token-line"><span class="token plain">    df_member[&#x27;已停付会费&#x27;].replace(to_replace=&#x27;否&#x27;,  value=0, inplace=True)</span></div><div class="token-line"><span class="token plain">    df_member[&#x27;性别&#x27;].replace(to_replace=&#x27;女&#x27;, value=0, inplace=True)</span></div><div class="token-line"><span class="token plain">    df_member[&#x27;性别&#x27;].replace(to_replace=&#x27;男&#x27;, value=1, inplace=True)</span></div></pre></div><p>而对于各种会员套餐类型，我们把汉字“是”、“否”转换成易于机器读取的布尔类型变量。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain"># 其它的是、否字段转换成布尔型数据</span></div><div class="token-line"><span class="token plain">    binary_features = [&#x27;玫瑰套餐&#x27;, &#x27;紫罗兰套餐&#x27;, &#x27;郁金香套餐&#x27;, </span></div><div class="token-line"><span class="token plain">                       &#x27;百合套餐&#x27;, &#x27;康乃馨套餐&#x27;, &#x27;胡姬花套餐&#x27;, </span></div><div class="token-line"><span class="token plain">                       &#x27;生日套餐&#x27;,&#x27;情人节套餐&#x27;]</span></div><div class="token-line"><span class="token plain">    for field in binary_features:</span></div><div class="token-line"><span class="token plain">        df_member[field] = df_member[field] == &#x27;是&#x27;</span></div></pre></div><p>这时候，数据集情况如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage037c0346762e6ae2079b006159acf6d2ee7c.57159a3b.png" alt=""/></p><p>下一步，我们要做另外一个可视化工作，就是显示会员的留存曲线，这个曲线在留存分析中非常重要，可以让我们发现用户留存相关的很多秘密，所以，我专门拉出来好好给你讲一讲。</p><h2 id="kaplan-meier生存模型显示整体留存曲线"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#kaplan-meier生存模型显示整体留存曲线"><span class="icon icon-link"></span></a>Kaplan-Meier生存模型：显示整体留存曲线</h2><p>绘制留存曲线，通常的做法是用Python手工绘图，这里我要向你推荐一个非常好用的工具包：lifelines（生命线库），它的优点是简单快捷，还能显示整个数据集中用户随着时间推移的留存情况。</p><p>lifelines最早是由精算师和医疗专业人员开发的，通过病人的病情和其他特征，来分析病人的生存可能性。后来，数据分析师们发现，这个模型既然能够判断哪些因子会影响病人的存活率（死亡率），那么，要是把因子换成用户行为特征和产品特征，不就也能分析出用户的留存率（流失率）吗？于是，这个工具被运营人员和数据分析师利用了起来，为分析用户留存提供了很多有用的方法。</p><p>在lifelines工具包中有一个Kaplan-Meier生存模型，它能显示整体的用户留存曲线，通过绘制不同群体的留存曲线，我们就可以观察到数据集中的各个特征对于留存的影响大小。</p><p>现在，我们回到这个项目的数据集，观察一下哪些指标与“留存时间”的关系最密切：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage037c0346762e6ae2079b006159acf6d2ee7c.57159a3b.png" alt=""/></p><p>你看出来了吗？它们分别是最后一个字段‘已停付会费’，以及第三个字段‘入会月数’”。有了这两个指标，我们就可以计算出这些用户的生命周期长度，也就是他们大概在入会多长时间后会流失了。</p><p>首先我们要安装lifelines工具包：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">pip install lifelines</span></div></pre></div><p>下面，我们导入lifelines，用其中的Kaplan-Meier生存模型来查看普通用户随时间而变化的留存率。我们把“入会月数” 和“已停付会费”两个字段输入该模型，这个模型可以拟合用户数据，并以绘制出含置信区间的用户留存曲线。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import lifelines #导入生存分析工具包</span></div><div class="token-line"><span class="token plain">    kmf = lifelines.KaplanMeierFitter() #创建KMF模型</span></div><div class="token-line"><span class="token plain">    kmf.fit(df_member[&#x27;入会月数&#x27;], #拟合易速鲜花会员流失数据</span></div><div class="token-line"><span class="token plain">            event_observed=df_member[&#x27;已停付会费&#x27;], </span></div><div class="token-line"><span class="token plain">            label=&#x27;会员预期留存线&#x27;)</span></div><div class="token-line"><span class="token plain">    fig, ax = plt.subplots(figsize=(10,6)) #画布</span></div><div class="token-line"><span class="token plain">    kmf.plot(ax=ax) #绘图</span></div><div class="token-line"><span class="token plain">    ax.set_title(&#x27;Kaplan-Meier留存曲线-易速鲜花会员们&#x27;) #图题</span></div><div class="token-line"><span class="token plain">    ax.set_xlabel(&#x27;入会月数&#x27;) #X轴标签</span></div><div class="token-line"><span class="token plain">    ax.set_ylabel(&#x27;留存率(%)&#x27;) #Y轴标签</span></div><div class="token-line"><span class="token plain">    plt.show() #显示图片</span></div></pre></div><p>输出如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage0def0d7e570660dc58a1a4961f70c56067ef.01bc66ae.png" alt=""/></p><p>你看，图中的曲线有蓝色的阴影，这个阴影就是置信区间。置信区间是一个范围，比如说有一批学生的考试成绩是从0到100分，如果我们给出一个分数的区间[55分-95分]，然后说 “该区间的置信水平为95%”，这就代表学生的考试成绩落在这个范围的概率是95%。这里的[55分-95分] 就被称做置信水平为95%的学生考试成绩的置信区间。一般来说，我们使用95%的置信水平进行区间估计。</p><p>从我们这个项目来看，考虑到图中留存率的蓝色阴影所覆盖的范围，我们可以说入会月数为20个月之后，有95%的可能，用户留存的概率在78%-82%之间。而在第70个月之后，也就是注册为会员5年之后，留存率有95%的可能在58％-64%这个概率区间。</p><p>不过，上面的留存曲线并不能给我们提供更多的用户特定分组的留存情况的对比信息，我们还需要从用户特征入手，分组绘制留存曲线，然后在同一张图中显示，这样可以帮我们挖掘出更多影响用户留存率的因素。</p><p>下面，我们就根据用户特征来绘制不同的细分留存曲线。我们先创建一个函数，让这个函数根据用户具体特征，也就是生存分析中的因子，来专门绘制留存曲线：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">def life_by_cat(feature, t=&#x27;入会月数&#x27;, event=&#x27;已停付会费&#x27;, df=df_member, ax=None): #定义分类留存曲线函数</span></div><div class="token-line"><span class="token plain">        for cat in df[feature].unique(): #遍历类别</span></div><div class="token-line"><span class="token plain">            idx = df[feature] == cat #当前类别</span></div><div class="token-line"><span class="token plain">            kmf = lifelines.KaplanMeierFitter() #创建KaplanMeier模型</span></div><div class="token-line"><span class="token plain">            kmf.fit(df[idx][t], event_observed=df[idx][event], label=cat) #拟合模型</span></div><div class="token-line"><span class="token plain">            kmf.plot(ax=ax, label=cat) #绘图</span></div></pre></div><p>有了这个函数，我们就可以显示用户细分类别的留存曲线，并进行对比。</p><p>下面，我们先看看会员费缴纳方式对留存的影响，操作很简单，我们只需要把这个字段传输进刚才定义的life_by_cat函数即可：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">fig_pmt, ax_pmt = plt.subplots(figsize=(10,6)) #画布</span></div><div class="token-line"><span class="token plain">    life_by_cat(feature=&#x27;会费支付方式&#x27;, ax=ax_pmt) #调用函数</span></div><div class="token-line"><span class="token plain">    ax_pmt.set_title(&#x27;会费支付方式对留存的影响&#x27;) #图题</span></div><div class="token-line"><span class="token plain">    ax_pmt.set_xlabel(&#x27;入会月数&#x27;) #X轴标签</span></div><div class="token-line"><span class="token plain">    ax_pmt.set_ylabel(&#x27;留存率(%)&#x27;) #Y轴标签</span></div><div class="token-line"><span class="token plain">    plt.show() #显示图片</span></div></pre></div><p>输出如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagef7ccf750afe8b5224ee0fe04ea3bac47a0cc.8564f294.png" alt=""/></p><p>可以看到，如果选择就餐时付会员费，那么流失率将大幅上升。那我们就有理由怀疑，如果要客户下次就餐时支付会员费，那会使很多用户干脆不再前来就餐。另一个对留存有负面影响的支付方式是手工转账支付会员费。而最佳的会员费支付方案是说服用户采用微信自动扣款，或通过花呗付款。</p><p>接着，我们再借助这个life_by_cat函数，来看看男生与女生的留存周期有没有显著差异。你先猜一猜，性别对于易速鲜花的会员留存率的影响，会不会像付款方式那么大？</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">fig_gender, ax_gender = plt.subplots(figsize=(10,6)) #画布</span></div><div class="token-line"><span class="token plain">    life_by_cat(feature=&#x27;性别&#x27;, ax=ax_gender) #调用函数</span></div><div class="token-line"><span class="token plain">    ax_gender.set_title(&#x27;性别对留存的影响&#x27;) #图题</span></div><div class="token-line"><span class="token plain">    ax_gender.set_xlabel(&#x27;入会月数&#x27;) #X轴标签</span></div><div class="token-line"><span class="token plain">    ax_gender.set_ylabel(&#x27;留存率(%)&#x27;) #Y轴标签</span></div><div class="token-line"><span class="token plain">    plt.show() #显示图片</span></div></pre></div><p>输出如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagea5bda52c251520ee4f07cab8f5b5e046dfbd.230f88c1.png" alt=""/></p><p>你看，图中两条留存曲线几乎重合，这表明性别差异对易速鲜花用户留存影响并不是十分明显。想想也是，无论男生还是女生，对订购鲜花这件事情的喜好程度好像确实没有什么分别。</p><p>到这里呢，我们就通过按特征类别分组的留存曲线，显示出了哪些特征是对用户留存率是有影响的，哪些特征是没有影响的。不过，你可能还是会问：这个留存曲线展示的是全部的用户，或者至少是某一类用户的留存情况，可我的老板就是让我具体关注某几个高价值用户，那么有没有什么方法能展示出某一个人在未来10年或者20年后的留存情况呢？答案当然是有的。不过，这就要使用lifelines库中的另外一个工具，Cox危害系数模型。</p><h2 id="cox危害系数模型预测用户留存概率"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#cox危害系数模型预测用户留存概率"><span class="icon icon-link"></span></a>Cox危害系数模型：预测用户留存概率</h2><p>Cox危害系数模型（proportional hazards model）会分析每一个字段对于生存的影响，然后预测出某一个人大概在多久之后会“死亡”，并给出随时间延长，生存的概率值大小，也就是可能性。我们这个场景中的“死亡”，也就是指会员的流失。</p><p>所谓“危害”，你可以理解为风险因子，它用来表示分析该特征（或称为因子）是否会增加或减少生存机会，在这里，当然就是指对应特征对用户流失的影响之大小了。然后对用户个体就可以根据这些字段作为特征进行预测分析，判断未来用户留存或者流失的概率。</p><p>由于Cox危害系数模型可读取的格式是虚拟变量编码，而现在各字段的数据格式是分类编码，在调用该方法之前，我们还需要进一步做点数据的整理工作，把每个字段都规范成为Cox模型可以读取的格式。</p><h3 id="1-数据预处理"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#1-数据预处理"><span class="icon icon-link"></span></a>1. 数据预处理</h3><p>先通过Pandas中的pd.get_dummies方法，可以把多类别字段分解为多个二元类别字段，也就是之前在<a target="_blank" rel="noopener noreferrer" href="https://time.geekbang.org/column/article/418354">第8讲<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>说过的虚拟变量。比如把“会员卡类型”字段，拆分为“会员卡类型-年卡”、“会员卡类型-月卡”、“会员卡类型-双年卡”等。这样一来，输入Cox危害系数模型的所有字段都是二元类别字段，都只有1，0（是，否）两个类别。</p><p>你可能觉得奇怪，为什么这个步骤没在之前的特征工程部分完成呢？这是因为我们希望保留“会费支付方式”、“会员卡类型”等这些分类字段来展示不同用户分组的留存曲线，而一旦划分为虚拟变量，原始字段就会消失，所以，我们现在才做这个步骤。</p><p>具体的拆解代码如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#把分类字段转换为哑编码</span></div><div class="token-line"><span class="token plain">    category_features = [&#x27;会员卡类型&#x27;, &#x27;会费支付方式&#x27;] #要转换的分类的字段</span></div><div class="token-line"><span class="token plain">    df_member = pd.get_dummies(df_member, #哑变量的个数会比总类别数少1 </span></div><div class="token-line"><span class="token plain">                               drop_first=True, #这是因为drop_first=True</span></div><div class="token-line"><span class="token plain">                               columns=category_features) #这能够避免回归中的多重共线性问题 </span></div><div class="token-line"><span class="token plain">    df_member #显示数据</span></div></pre></div><p>在这段代码中，关于drop_first = True的含义，我们在<a target="_blank" rel="noopener noreferrer" href="https://time.geekbang.org/column/article/418354">第8讲<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中已经探讨过了。如果我们为分类变量的 k个级别保留 k个虚拟变量，就会存在一个级别的冗余。对于多元线性回归模型来说，这会导致数据集中的多重共线性问题，从而影响回归曲线的建模。</p><p>把多类别字段分解为多个二元类别字段后，新的数据集如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagee8b9e8a96f17cd70a66a3b60c2c4b2d5aeb9.b2844ac7.png" alt=""/></p><p>整理好数据后，我们开始创建模型。</p><h3 id="2-创建并拟合模型"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#2-创建并拟合模型"><span class="icon icon-link"></span></a>2. 创建并拟合模型</h3><p>下面的语句就创建出Cox模型。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cph = lifelines.CoxPHFitter() #创建CoxPH模型</span></div></pre></div><p>然后，我们用数据集拟合模型：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cph.fit(df_member, duration_col=&#x27;入会月数&#x27;, #拟合模型</span></div><div class="token-line"><span class="token plain">            event_col=&#x27;已停付会费&#x27;, show_progress=False)</span></div></pre></div><p>模型拟合结束后，就可以显示某一个用户的生存周期了。</p><h3 id="3-显示留存概率曲线"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#3-显示留存概率曲线"><span class="icon icon-link"></span></a>3. 显示留存概率曲线</h3><p>我们通过模型中的predict_survival_function函数，来显示对其中某一个用户的生存概率的预测：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#显示会员生存曲线</span></div><div class="token-line"><span class="token plain">    cph.predict_survival_function(df_member.loc[3]).plot()</span></div></pre></div><p>留存概率曲线输出如下：</p><p><img src="data:image/png;base64,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" alt=""/></p><p>对这个用户来说，初始的留存概率当然是1.0；在注册会员10个月之后，他留存下来的可能性降低到50%左右；在注册会员20个月之后，他留存的概率减少到了20%以下；30个月之后，这个用户就极有可能会流失，此时的留存概率几乎为0。</p><p>到这里，我们已经能够预测出用户的留存时间长短，但是怎么知道每一个指标（特征字段），对用户流失的影响有多大呢？其实，Cox危害系数模型仍然能帮到我们。</p><h2 id="cox危害系数模型分析影响留存的因子"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#cox危害系数模型分析影响留存的因子"><span class="icon icon-link"></span></a>Cox危害系数模型：分析影响留存的因子</h2><p>Cox危害系数模型的用途不仅限于预测用户留存的概率，它还可以用来挖掘各个特征字段和用户留存（也就是生命周期）的关联程度。</p><p>下面这段代码就通过可视化的方式，来显示每一个特征的危害系数及其置信区间。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">fig, ax = plt.subplots(figsize=(12,7)) #画布</span></div><div class="token-line"><span class="token plain">    ax.set_title(&#x27;各个特征的留存相关系数&#x27;) #图题</span></div><div class="token-line"><span class="token plain">    cph.plot(ax=ax) #绘图</span></div></pre></div><p>输出如下：</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimagea62fa62056dac085b2f6d8b7e5b9f07baf2f.5ec838de.png" alt=""/></p><p>在这个图中，大于0的系数值预示着对留存有负面影响，值越大，影响越大；而小于0的系数值则对留存有正面影响，值越小，影响越大。</p><p>可以看出，像月卡、手工转账支付会员费这些，都是潜在的流失原因。这说明，“易速鲜花”应该努力让用户办长期卡，用自动付费取代手工转账。而各种优惠套餐的危害系数都小于0，说明参与这些活动的会员留存率会有显著提高，所以，应该让会员积极参与这些活动，有利于留存。</p><p>好啦，到这里，我们就成功找到了与用户留存高度相关的因子。那么接下来，运营团队会怎么设计新的会员配套、怎么说服会员尽量签订长期合同、怎么优化付款方式……就都是他们的事儿啦。</p><h2 id="总结一下"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#总结一下"><span class="icon icon-link"></span></a>总结一下</h2><p>现在，我们来做个总结。今天我们主要学习了lifelines这个生存分析库，这个包中有很多用来进行留存分析的实用工具。</p><p>其中，Kaplan-Meier生存模型能帮助我们显示整体的用户留存曲线，通过绘制不同特征类型的人群的留存曲线，我们可以观察到不同特征对于留存的影响。经过观察，我们发现“易速鲜花”会员入会5年之后，整体留存率还能够在60%左右。而性别对于留存率的影响并不明显，但是会员缴纳会费的方式，则能够对留存率产生影响，这就指导我们在营销时，应该尽量说服会员在办卡时选择自动付费。</p><p>此外，我们还介绍了lifelines中的Cox危害系数模型，这个模型能帮我们预测特定用户的留存概率，并显示出数据集各个特征与留存相关的系数。这个相关系数和留存曲线一样，让我们能够发现对用户留存率产生正面和负面影响的因子。比如说给会员的各种优惠套餐配套，都对老会员的留存起到了正面作用，而有些套餐，比如郁金香套餐，胡姬花套餐等，正面作用尤为明显。</p><p>总之，这两个工具为我们做会员留存分析，提供了非常有用的指导性信息，希望你能用好它。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog-other/零基础实战机器学习/03.业务场景闯关篇/10#思考题"><span class="icon icon-link"></span></a>思考题</h2><p>这节课就到这里了，我给你留两个思考题：</p><ol><li>显示整体留存曲线时，我选择了会费支付方式和性别这两个字段，查看特征字段对留存是否有影响。那么，在这个数据集中，你还能找到哪个字段，会对留存与否产生比较大的影响呢？请你绘制这个字段的留存曲线。</li><li>除了我们这里介绍的Lifelines生命线工具包，你还能找到，或者用过哪些工具，能够辅助我们找到影响用户留存的因子呢？</li></ol><p>欢迎你在留言区和我分享你的观点，如果你认为这节课的内容有收获，也欢迎把它分享给你的朋友，我们下一讲再见！</p><p><img src="/blog-other/static/httpsstatic001geekbangorgresourceimage4fb54f13d2cdd2397b58184e7234365df3b5.dfcc10f7.jpg" alt=""/></p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/零基础实战机器学习/03.业务场景闯关篇/10.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/23 21:58:31</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-other/umi.js"></script>
  </body>
</html>
